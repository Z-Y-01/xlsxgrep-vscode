<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <style>
        body { padding: 10px; display: flex; flex-direction: column; gap: 10px; font-family: var(--vscode-font-family); color: var(--vscode-foreground); }
        input[type="text"] { width: 100%; padding: 5px; background: var(--vscode-input-background); color: var(--vscode-input-foreground); border: 1px solid var(--vscode-input-border); box-sizing: border-box; }
        
        /* 复选框容器样式 */
        .checkbox-container { display: flex; align-items: center; gap: 5px; cursor: pointer; font-size: 12px; }
        .checkbox-container input { cursor: pointer; margin: 0; }
        
        button { cursor: pointer; background: var(--vscode-button-background); color: var(--vscode-button-foreground); border: none; padding: 6px; width: 100%; }
        button:hover { background: var(--vscode-button-hoverBackground); }
    </style>
</head>
<body>
    <div class="input-group">
        <div class="input-label">Search Content (搜索内容)</div>
        <input type="text" id="searchInput" placeholder="Search content..." />
    </div>

    <label class="checkbox-container">
        <input type="checkbox" id="WholeMatchCellCheckbox" />
        <span>Whole Word Match (全字匹配)</span>
    </label>

    <label class="checkbox-container">
        <input type="checkbox" id="CaseMatchCellCheckbox" />
        <span>Case Sensitivity (区分大小写)</span>
    </label>

    <label class="checkbox-container">
        <input type="checkbox" id="UseRegexCheckbox" />
        <span>Use Regex (使用正则表达式)</span>
    </label>

    <div class="input-group">
        <div class="input-label">File Name Pattern (文件名过滤)</div>
        <input type="text" id="filePatternInput" placeholder="e.g. Motive..." />
    </div>

    <label class="checkbox-container">
        <input type="checkbox" id="OnlyActiveFileCheckbox" />
        <span>Search Only Currently Open Files (仅搜当前打开的文件)</span>
    </label>

    <div class="button-container">
        <button id="searchBtn">SEARCH</button>
    </div>

    <script>
        const vscode = acquireVsCodeApi();
        const searchBtn = document.getElementById('searchBtn');
        const searchInput = document.getElementById('searchInput');
        const filePatternInput = document.getElementById('filePatternInput'); // 新增
        const WholeMatchCellCheckbox = document.getElementById('WholeMatchCellCheckbox');
        const CaseMatchCellCheckbox = document.getElementById('CaseMatchCellCheckbox');
        const OnlyActiveFileCheckbox = document.getElementById('OnlyActiveFileCheckbox');
        const UseRegexCheckbox = document.getElementById('UseRegexCheckbox');

        searchBtn.addEventListener('click', () => {
            vscode.postMessage({ 
                command: 'search', 
                targetVal: searchInput.value,           // 搜索内容
                filePattern: filePatternInput.value,    // 文件名过滤
                isWholeExactMatch: WholeMatchCellCheckbox?.checked ?? false,
                isCaseExactMatch: CaseMatchCellCheckbox?.checked ?? false,
                bOnlyActiveFiles: OnlyActiveFileCheckbox?.checked ?? false,
                bUseRegex: UseRegexCheckbox?.checked ?? false,
            });
        });

        // 支持所有输入框的回车搜索
        [searchInput, filePatternInput].forEach(el => {
            el.addEventListener('keydown', (e) => {
                if (e.key === 'Enter') searchBtn.click();
            });
        });
    </script>
</body>
</html>